- include: ubuntu.yaml
  when: ansible_distribution == "Ubuntu"

- include: ubuntu-aarch64.yaml
  when: ansible_architecture == "aarch64"

- include: osx.yaml
  when: ansible_distribution == "MacOSX"

- include: arch.yaml
  when: ansible_distribution == "Archlinux"

- name: install python language server and extras through pipx
  shell:
    cmd: |
      pipx install python-lsp-server || ~/.local/bin/pipx install python-lsp-server
      pipx inject python-lsp-server pylsp-mypy python-lsp-black pyls-isort || ~/.local/bin/pipx inject python-lsp-server pylsp-mypy python-lsp-black pyls-isort
    creates: ~/.local/bin/pylsp

- name: link neovim config
  shell:
    chdir: "{{ repo_path }}/files"
    cmd: stow --target="$HOME" {{ item }}
  with_items:
    - neovim
